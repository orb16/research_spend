ggplot(fundingSmallerSide2, aes(x = TIME_PERIOD, y = OBS_VALUE / population)) +
geom_line(aes(colour = Price.base)) +
geom_point(aes(colour = Price.base)) +
facet_wrap(~Socio.economic.objectives) +
theme_bw()
ggplot(fundingSmallerSide, aes(x = TIME_PERIOD, y = OBS_VALUE / GDP)) +
geom_line(aes(colour = Price.base)) +
geom_point(aes(colour = Price.base)) +
facet_wrap(~Socio.economic.objectives) +
theme_bw()
ggplot(fundingSmaller, aes(x = TIME_PERIOD, y = OBS_VALUE)) +
geom_line(aes(colour = Price.base)) +
geom_point(aes(colour = Price.base)) +
facet_wrap(~Socio.economic.objectives) +
theme_bw()
ggplot(fundingSmallerSide, aes(x = TIME_PERIOD, y = OBS_VALUE / GDP)) +
geom_line(aes(colour = Price.base)) +
geom_point(aes(colour = Price.base)) +
facet_wrap(~Socio.economic.objectives) +
theme_bw()
# by country
# spend on environment per head
popWorld <- pop %>%
dplyr::select(TIME_PERIOD, population = OBS_VALUE, Reference.area)
popWorld
ggplot(data = popWorld, aes(x = TIME_PERIOD, y = population)) +
geom_line()+
facet_wrap(~Reference.area)
ggplot(data = popWorld, aes(x = TIME_PERIOD, y = population)) +
geom_line()+
facet_wrap(~Reference.area, scales = "free")
fundingSmallerWorld <- funding %>%
filter(Socio.economic.objectives %in% c("Total", "Environment", "Agriculture"))
fundingSmallerWorld <- funding %>%
filter(Socio.economic.objectives %in% c("Total", "Environment", "Agriculture")) %>%
left_join(popWorld)
nrow(funding %>%
filter(Socio.economic.objectives %in% c("Total", "Environment", "Agriculture")))
nrow(fundingSmallerWorld)
ggplot(fundingSmallerSide, aes(x = TIME_PERIOD, y = OBS_VALUE / population)) +
geom_line(aes(colour = Price.base)) +
geom_point(aes(colour = Price.base)) +
facet_wrap(~Socio.economic.objectives) +
theme_bw()
ggplot(fundingSmallerSide, aes(x = TIME_PERIOD, y = OBS_VALUE / population)) +
geom_line(aes(colour = Price.base)) +
geom_point(aes(colour = Price.base)) +
facet_wrap(Reference.area~Socio.economic.objectives) +
theme_bw()
fundingSmallerSide
unique(fundingSmallerWorld$Price.base)
fundingSmallerWorld <- funding %>%
filter(Socio.economic.objectives %in% c("Total", "Environment", "Agriculture") &
filter(Price.base == "Current prices")) %>%
left_join(popWorld)
fundingSmallerWorld <- funding %>%
filter(Socio.economic.objectives %in% c("Total", "Environment", "Agriculture") &
Price.base == "Current prices")) %>%
fundingSmallerWorld <- funding %>%
filter(Socio.economic.objectives %in% c("Total", "Environment", "Agriculture") &
Price.base == "Current prices") %>%
left_join(popWorld)
nrow(funding %>%
filter(Socio.economic.objectives %in% c("Total", "Environment", "Agriculture")))
nrow(fundingSmallerWorld)
nrow(funding %>%
filter(Socio.economic.objectives %in% c("Total", "Environment", "Agriculture") &
Price.base == "Current prices"))
nrow(fundingSmallerWorld)
ggplot(fundingSmallerSide, aes(x = TIME_PERIOD, y = OBS_VALUE / population)) +
geom_line(aes(colour = Socio.economic.objectives)) +
geom_point(aes(colour = Socio.economic.objectives)) +
facet_wrap(~Reference.area) +
theme_bw()
names(fundingSmallerSide)
names(fundingSmallerSide) %in% c("TIME_PERIOD", "OBS_VALUE", "population")
c("TIME_PERIOD", "OBS_VALUE", "population") %in% names(fundingSmallerSide)
fundingSmallerWorld <- funding %>%
filter(Socio.economic.objectives %in% c("Total", "Environment", "Agriculture") &
Price.base == "Current prices") %>%
left_join(., popWorld)
ggplot(fundingSmallerWorld, aes(x = TIME_PERIOD, y = OBS_VALUE / population)) +
geom_line(aes(colour = Socio.economic.objectives)) +
geom_point(aes(colour = Socio.economic.objectives)) +
facet_wrap(~Reference.area) +
theme_bw()
ggplot(fundingSmallerWorld, aes(x = TIME_PERIOD, y = OBS_VALUE / population)) +
geom_line(aes(colour = Socio.economic.objectives)) +
geom_point(aes(colour = Socio.economic.objectives)) +
facet_wrap(~Reference.area) +
theme_bw() +
theme(legend.position = 'bottom')
bal <- fundingSmallerWorld %>% filter(TIME_PERIOD == 2021)
bal
bal <- fundingSmallerWorld %>% filter(TIME_PERIOD == 2021) %>%
mutate(fundingPerPop = OBS_VALUE / population)
bal
ggplot(bal, aes(x =Reference.area, y = fundingPerPop)) +
geom_bar(stat = "identity")
ggplot(bal, aes(x =Reference.area, y = fundingPerPop)) +
geom_bar(stat = "identity", aes(fill = Socio.economic.objectives),
position = position_stack())
ggplot(bal, aes(x =Reference.area, y = fundingPerPop)) +
geom_bar(stat = "identity", aes(fill = Socio.economic.objectives),
position = position_stack()) +
theme_minimal() +
theme(axis.text.x = element_text(hjust = 1, angle = 45))
gdpSmaller
# GDP in US dollars, but total, not PP
#https://data-explorer.oecd.org/vis?df[ds]=dsDisseminateFinalDMZ&df[id]=DSD_NAMAIN10%40DF_TABLE1_EXPENDITURE_VPVOB&df[ag]=OECD.SDD.NAD&df[vs]=&dq=A.AUS%2BAUT%2BBEL%2BCAN%2BCHL%2BCOL%2BCRI%2BCZE%2BDNK%2BEST%2BFIN%2BFRA%2BDEU%2BGRC%2BHUN%2BISL%2BIRL%2BISR%2BITA%2BJPN%2BKOR%2BLVA%2BLTU%2BLUX%2BMEX%2BNLD%2BNZL%2BNOR%2BPOL%2BPRT%2BSVK%2BSVN%2BESP%2BSWE%2BCHE%2BTUR%2BGBR%2BUSA...B1GQ.......&lom=LASTNPERIODS&lo=10&to[TIME_PERIOD]=false&vw=tb
gdpNew <- read.csv("input/OECD.SDD.NAD,DSD_NAMAIN10@DF_TABLE1_EXPENDITURE_VPVOB,+A.AUS+AUT+BEL+CAN+CHL+COL+CRI+CZE+DNK+EST+FIN+FRA+DEU+GRC+HUN+ISL+IRL+ISR+ITA+JPN+KOR+LVA+LTU+LUX+MEX+NLD+NZL+NOR+POL+PRT+SVK+SVN+ESP+SWE+CHE+TUR+GBR+USA...B1GQ........csv")
gdpNew
ggplot(gdpNew, aes(x = TIME_PERIOD, y = OBS_VALUE)) +
geom_line() +facet_wrap(~Reference.area, scales = "free_y")
?read_csv
gdp_world_bank <- read_csv("input/API_NY.GDP.MKTP.CD_DS2_en_csv_v2_25118/API_NY.GDP.MKTP.CD_DS2_en_csv_v2_25118.csv", skip = 4)
head(gdp_world_bank)
gdp_world_bank
View(gdp_world_bank)
names(gdp_world_bank)
gdp_world_bank %>% pull(`...70`)
# world bank
# https://data.worldbank.org/indicator/NY.GDP.MKTP.CD
gdp_world_bank <- read_csv("input/API_NY.GDP.MKTP.CD_DS2_en_csv_v2_25118/API_NY.GDP.MKTP.CD_DS2_en_csv_v2_25118.csv", skip = 4) %>%
dplyr::select(-`...70`)
gdp_world_bank_long <- gdp_world_bank %>%
gather(year, GDPvalue, `1960:2024`)
gdp_world_bank_long <- gdp_world_bank %>%
gather(year, GDPvalue, `1960`:`2024`)
gdp_world_bank_long
gdp_world_bank_long <- gdp_world_bank %>%
gather(year, GDPvalue, `1960`:`2024`) %>%
filter(year > 2014)
gdp_world_bank_long
# by other GDP ----
ourCountries <- unique(fundingSmallerWorld$REF_AREA)
gdpCountries <- unique(gdp_world_bank_long$`Country Code`)
ourCountries %in%  gdpCountries
ourCountries
head(gdp_world_bank_long)
gdp_world_bank_long2 <- gdp_world_bank_long %>%
rename(REF_AREA = `Country Code`, TIME_PERIOD = year)
combotab <- left_join(fundingSmallerWorld, gdp_world_bank_long2)
gdp_world_bank_long2 <- gdp_world_bank_long %>%
rename(REF_AREA = `Country Code`, TIME_PERIOD = year) %>%
mutate(TIME_PERIOD = as.numeric(TIME_PERIOD))
gdp_world_bank_long2
combotab <- left_join(fundingSmallerWorld, gdp_world_bank_long2)
combotab2021 <- combotab %>%
filter(TIME_PERIOD == 2021)
combotab2021
ggplot(combotab2021, aes( x= TIME_PERIOD, y = OBS_VALUE / GDPvalue)) +
geom_bar(aes(fill = Socio.economic.objectives))
ggplot(combotab2021, aes( x= TIME_PERIOD, y = OBS_VALUE / GDPvalue)) +
geom_bar(aes(fill = Socio.economic.objectives),
stat = "identity")
ggplot(combotab2021, aes( x= TIME_PERIOD, y = OBS_VALUE / GDPvalue)) +
geom_bar(aes(fill = Reference.area),
stat = "identity")
ggplot(combotab2021, aes( x= Reference.area, y = OBS_VALUE / GDPvalue)) +
geom_bar(aes(fill = Socio.economic.objectives),
stat = "identity")
ggplot(combotab2021, aes( x= Reference.area, y = OBS_VALUE / GDPvalue)) +
geom_bar(aes(fill = Socio.economic.objectives),
stat = "identity") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
head(combotab2021)
ggplot(combotab2021, aes( x= Reference.area, y = 1000000 * OBS_VALUE / GDPvalue)) +
geom_bar(aes(fill = Socio.economic.objectives),
stat = "identity") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(combotab2021, aes( x= Reference.area, y = 100 * 1000000 * OBS_VALUE / GDPvalue)) +
geom_bar(aes(fill = Socio.economic.objectives),
stat = "identity") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
gdpNew
gdpNew %>%
dplyr::select(OBS_VALUE, TIME_PERIOD, Reference.area, Unit.multiplier
)
newgdpTab <- gdpNew %>%
dplyr::select(OBS_VALUE, TIME_PERIOD, Reference.area, Unit.multiplier
)
megaTab <- left_join(fundingSmallerWorld, newgdpTab)
newgdpTab <- gdpNew %>%
dplyr::select(GDP = OBS_VALUE, TIME_PERIOD, Reference.area, gdpMult = Unit.multiplier
)
megaTab <- left_join(fundingSmallerWorld, newgdpTab)
nrow(megaTab)
nrow(fundingSmallerWorld)
fundingSmallerWorld
megaTab <- left_join(fundingSmallerWorld, newgdpTab) %>%
mutate(spendPerGDP = 100 * OBS_VALUE / GDP)
head(megaTab)
ggplot(megaTab %>% filter(Reference.area == "New Zealand" & Socio.economic.objectives=="Total"),
aes(x = TIME_PERIOD, y = spendPerGDP)) +
geom_line()
ggplot(megaTab %>% filter(Reference.area == "New Zealand" & Socio.economic.objectives=="Total"),
aes(x = TIME_PERIOD, y = spendPerGDP)) +
geom_line() +
theme_minimal()
ggplot(combotab2021, aes( x= Reference.area, y = 100 * 1000000 * OBS_VALUE / GDPvalue)) +
geom_bar(aes(fill = Socio.economic.objectives),
stat = "identity") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
fundingSmallerWorld
fundingSmallerWorld
ggplot(megaTab %>% filter(Reference.area == "New Zealand"),
aes(x = TIME_PERIOD, y = spendPerGDP)) +
geom_line(aes(colour = Socio.economic.objectives)) +
theme_minimal()
ggplot(megaTab %>% filter(TIME_PERIOD == 2021),
aes(x = Reference.area, y = spendPerGDP)) +
geom_bar(aes(fill = Socio.economic.objectives),
position = position_stack(), stat = "identity") +
theme_minimal()
ggplot(megaTab %>% filter(TIME_PERIOD == 2021),
aes(x = Reference.area, y = spendPerGDP)) +
geom_bar(aes(fill = Socio.economic.objectives),
position = position_stack(), stat = "identity") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(megaTab %>% filter(TIME_PERIOD == 2021 & Socio.economic.objectives == "TOtal "),
aes(x = Reference.area, y = spendPerGDP)) +
geom_bar(aes(fill = Socio.economic.objectives),
position = position_stack(), stat = "identity") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(megaTab %>% filter(TIME_PERIOD == 2021 & Socio.economic.objectives == "Total"),
aes(x = Reference.area, y = spendPerGDP)) +
geom_bar(aes(fill = Socio.economic.objectives),
position = position_stack(), stat = "identity") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(megaTab %>% filter(TIME_PERIOD == 2021 & Socio.economic.objectives == "Environment"),
aes(x = Reference.area, y = OBS_VALUE)) +
geom_bar(aes(fill = Socio.economic.objectives),
position = position_stack(), stat = "identity") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(megaTab %>% filter(TIME_PERIOD == 2021 & Socio.economic.objectives == "Agriculture"),
aes(x = Reference.area, y = OBS_VALUE)) +
geom_bar(aes(fill = Socio.economic.objectives),
position = position_stack(), stat = "identity") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(megaTab %>% filter(TIME_PERIOD == 2021 & Socio.economic.objectives == "Agriculture"),
aes(x = Reference.area, y = OBS_VALUE)) +
geom_bar(aes(fill = Socio.economic.objectives),
position = position_stack(), stat = "identity") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
worldBankSpend <- read_csv("input/API_GB.XPD.RSDV.GD.ZS_DS2_en_csv_v2_22590/API_GB.XPD.RSDV.GD.ZS_DS2_en_csv_v2_22590.csv",
skip = 4)
head(worldBankSpend)
names(worldBankSpend)
worldBankSpend <- read_csv("input/API_GB.XPD.RSDV.GD.ZS_DS2_en_csv_v2_22590/API_GB.XPD.RSDV.GD.ZS_DS2_en_csv_v2_22590.csv",
skip = 4) %>%
dplyr::select(-`...70`) %>%
gather(Year, percSpend, `1960`:`2024`)
worldBankSpend
worldBankSpend <- read_csv("input/API_GB.XPD.RSDV.GD.ZS_DS2_en_csv_v2_22590/API_GB.XPD.RSDV.GD.ZS_DS2_en_csv_v2_22590.csv",
skip = 4) %>%
dplyr::select(-`...70`) %>%
gather(Year, percSpend, `1960`:`2024`) %>%
mutate(Year = as.numeric(Year)) %>%
filter(Year > 2014)
ggplot(worldBankSpend, aes(x = Year, y = percSpend)) +
geom_line(aes(colour = `Country Name`))
ggplot(worldBankSpend %>% filter(`Country Name` %in% c("New Zealand", "Australia", "Ireland", "Switzerland",
"Singapore")), aes(x = Year, y = percSpend)) +
geom_line(aes(colour = `Country Name`))
worldBankSpend %>% filter(`Country Name` == "New Zealand")
ggplot(worldBankSpend %>% filter(`Country Name` %in% c("New Zealand", "Australia", "Ireland", "Switzerland",
"Singapore")), aes(x = Year, y = percSpend)) +
geom_line(aes(colour = `Country Name`)) +
geom_point(aes(colour = `Country Name`))
ggplot(worldBankSpend %>% filter(`Country Name` %in% c("New Zealand", "Australia", "Ireland", "Switzerland",
"Singapore")), aes(x = Year, y = percSpend)) +
geom_line(aes(colour = `Country Name`,
group = `Country Name`)) +
geom_point(aes(colour = `Country Name`))
worldBankSpend <- read_csv("input/API_GB.XPD.RSDV.GD.ZS_DS2_en_csv_v2_22590/API_GB.XPD.RSDV.GD.ZS_DS2_en_csv_v2_22590.csv",
skip = 4) %>%
dplyr::select(-`...70`) %>%
gather(Year, percSpend, `1960`:`2024`) %>%
mutate(Year = as.numeric(Year)) %>%
filter(Year > 2014) %>%
filter(!is.na(percSpend))
worldBankSpend %>% filter(`Country Name` == "New Zealand")
ggplot(worldBankSpend %>% filter(`Country Name` %in% c("New Zealand", "Australia", "Ireland", "Switzerland",
"Singapore")), aes(x = Year, y = percSpend)) +
geom_line(aes(colour = `Country Name`,
group = `Country Name`)) +
geom_point(aes(colour = `Country Name`))
ourCountries <- c("New Zealand", "Switzerland", "Ireland", "Israel", "Latvia", "Colombia", "Argentina",
"Romania", "Slovak Republic", "Portugal",
"Poland", "South Africa", "Lithuania", "Luxembourg",
"Türkiye", "Spain", "Italy", "Japan", "Chinese Taipei", "Korea", "Greece", "Estonia", "Hungary",
"Germany", "Russia", "Austria", "France", "Sweden", "Denmark")
worldBankSpend %>%
filter(`Country Name` %in% ourCountries)
worldBankSmaller <- worldBankSpend %>%
filter(`Country Name` %in% ourCountries)
theme_set(theme_minimal())
ggplot(worldBankSmaller %>% mutate(isNewZealand = ifelse(`Country Name` == "New Zealand", "New Zealand", "Other"))) +
geom_line(aes(colour = `Country Name`,
group = `Country Name`)) +
geom_point(aes(colour = `Country Name`))
ggplot(worldBankSmaller %>% mutate(isNewZealand = ifelse(`Country Name` == "New Zealand", "New Zealand", "Other")),
aes(x = Year, y = percSpend)) +
geom_line(aes(colour = `Country Name`,
group = `Country Name`)) +
geom_point(aes(colour = `Country Name`))
ggplot(worldBankSmaller %>% mutate(isNewZealand = ifelse(`Country Name` == "New Zealand", "New Zealand", "Other")),
aes(x = Year, y = percSpend)) +
geom_line(aes(colour = isNewZealand,
group = isNewZealand)) +
geom_point(aes(colour = isNewZealand))
ggplot(worldBankSmaller %>% mutate(isNewZealand = ifelse(`Country Name` == "New Zealand", "New Zealand", "Other")),
aes(x = Year, y = percSpend)) +
geom_line(aes(colour = isNewZealand,
group = `Country Name`)) +
geom_point(aes(colour = isNewZealand))
require(readxl)
worldBankCats <- read_excel("input/CLASS_2025_10_07.xlsx", 1)
#spend on sicence
worldBankSpend <- read_csv("input/API_GB.XPD.RSDV.GD.ZS_DS2_en_csv_v2_22590/API_GB.XPD.RSDV.GD.ZS_DS2_en_csv_v2_22590.csv",
skip = 4) %>%
dplyr::select(-`...70`) %>%
gather(Year, percSpend, `1960`:`2024`) %>%
mutate(Year = as.numeric(Year)) %>%
filter(Year > 2014) %>%
filter(!is.na(percSpend)) %>%
left_join(., worldBankCats)
worldBankCats
#spend on sicence
worldBankSpend <- read_csv("input/API_GB.XPD.RSDV.GD.ZS_DS2_en_csv_v2_22590/API_GB.XPD.RSDV.GD.ZS_DS2_en_csv_v2_22590.csv",
skip = 4) %>%
dplyr::select(-`...70`) %>%
gather(Year, percSpend, `1960`:`2024`) %>%
mutate(Year = as.numeric(Year)) %>%
filter(Year > 2014) %>%
filter(!is.na(percSpend)) %>%
left_join(., worldBankCats %>% rename(`Country Name` = Economy))
head(worldBankCats)
ggplot(worldBankSpend %>% filter(`Country Name` %in% c("New Zealand", "Australia", "Ireland", "Switzerland",
"Singapore")), aes(x = Year, y = percSpend)) +
geom_line(aes(colour =  `Income group` ,
group = `Country Name`)) +
geom_point(aes(colour =  `Income group` ))
ggplot(worldBankSmaller %>% mutate(isNewZealand = ifelse(`Country Name` == "New Zealand", "New Zealand", "Other")),
aes(x = Year, y = percSpend)) +
geom_line(aes(colour = `Country Name`,
group = `Country Name`)) +
geom_point(aes(colour = `Country Name`))
ggplot(worldBankSmaller %>% mutate(isNewZealand = ifelse(`Country Name` == "New Zealand", "New Zealand", "Other")),
aes(x = Year, y = percSpend)) +
geom_line(aes(colour =  `Income group` ,
group = `Country Name`)) +
geom_point(aes(colour =  `Income group` ))
worldBankSmaller <- worldBankSpend %>%
filter(`Country Name` %in% ourCountries)
ggplot(worldBankSmaller %>% mutate(isNewZealand = ifelse(`Country Name` == "New Zealand", "New Zealand", "Other")),
aes(x = Year, y = percSpend)) +
geom_line(aes(colour =  `Income group` ,
group = `Country Name`)) +
geom_point(aes(colour =  `Income group` ))
ggplot(worldBankSmaller %>% mutate(isNewZealand = ifelse(`Country Name` == "New Zealand", "New Zealand", "Other")),
aes(x = Year, y = percSpend)) +
geom_line(aes(colour =  `Income group` ,
group = `Country Name`)) +
geom_point(aes(colour =  `Income group` )) +
facet_wrap(~ `Income group` )
ggplot(worldBankSmaller %>% mutate(isNewZealand = ifelse(`Country Name` == "New Zealand", "New Zealand", "Other")),
aes(x = Year, y = percSpend)) +
geom_line(aes(colour =  isNewZealand ,
group = `Country Name`)) +
geom_point(aes(colour =  isNewZealand )) +
facet_wrap(~ `Income group` )
worldBankSmaller
worldBankSmaller
worldBankSmaller2021 <- worldBankSmaller %>%
filter(Year =- 2021)
worldBankSmaller2021 <- worldBankSmaller %>%
filter(Year == 2021)
worldBankSmaller2021 <- worldBankSmaller %>%
filter(Year == 2021) %>%
arrange(desc(percSpend))
cord <- worldBankSmaller2021$`Country Name`
ggplot(worldBankSmaller2021, aes(x = `CountryName`, y = percSpend)) +
geom_bar(stat = "identity")
ggplot(worldBankSmaller2021, aes(x = `Country Name`, y = percSpend)) +
geom_bar(stat = "identity")
ggplot(worldBankSmaller2021, aes(x = `Country Name`, y = percSpend)) +
geom_bar(stat = "identity") +
scale_x_discrete(limits = ourCountries)
ggplot(worldBankSmaller2021, aes(x = `Country Name`, y = percSpend)) +
geom_bar(stat = "identity") +
scale_x_discrete(limits = ourCountries) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(worldBankSmaller2021, aes(x = `Country Name`, y = percSpend)) +
geom_bar(stat = "identity", aes(fill = `Income group`)) +
scale_x_discrete(limits = ourCountries) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(worldBankSmaller2021, aes(x = `Country Name`, y = percSpend)) +
geom_bar(stat = "identity", aes(fill = `Income group`)) +
scale_x_discrete(limits = cord) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
head(worldBankCats)
ggplot(worldBankSmaller2021, aes(x = `Country Name`, y = percSpend)) +
geom_bar(stat = "identity", aes(fill = Region)) +
scale_x_discrete(limits = cord) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(worldBankSmaller %>% mutate(isNewZealand = ifelse(`Country Name` == "New Zealand", "New Zealand", "Other")),
aes(x = Year, y = percSpend)) +
geom_line(aes(colour = isNewZealand,
group = `Country Name`)) +
geom_point(aes(colour = isNewZealand))
ggplot(worldBankSmaller2021, aes(x = `Country Name`, y = percSpend)) +
geom_bar(stat = "identity", aes(fill = Region)) +
scale_x_discrete(limits = cord) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
worldBankSmaller2021 <- worldBankSpend %>%
filter(Year == 2021) %>%
mutate(inOrigGraph = `Country Name` %in% ourCountries)%>%
arrange(desc(percSpend))
cord <- worldBankSmaller2021$`Country Name`
worldBankSmaller2021_z <- worldBankSpend %>%
filter(Year == 2021) %>%
mutate(inOrigGraph = `Country Name` %in% ourCountries)%>%
arrange(desc(percSpend))
cord <- worldBankSmaller2021_z$`Country Name`
ggplot(worldBankSmaller2021_z, aes(x = `Country Name`, y = percSpend)) +
geom_bar(stat = "identity", aes(fill = Region)) +
scale_x_discrete(limits = cord) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
worldBankCats
head(worldBankSpend)
#spend on sicence
worldBankSpend <- read_csv("input/API_GB.XPD.RSDV.GD.ZS_DS2_en_csv_v2_22590/API_GB.XPD.RSDV.GD.ZS_DS2_en_csv_v2_22590.csv",
skip = 4) %>%
dplyr::select(-`...70`) %>%
gather(Year, percSpend, `1960`:`2024`) %>%
mutate(Year = as.numeric(Year)) %>%
filter(Year > 2014) %>%
filter(!is.na(percSpend)) %>%
left_join(., worldBankCats %>% rename(`Country Code` = Code))
worldBankSpend %>% filter(`Country Name` == "New Zealand")
ggplot(worldBankSpend %>% filter(`Country Name` %in% c("New Zealand", "Australia", "Ireland", "Switzerland",
"Singapore")), aes(x = Year, y = percSpend)) +
geom_line(aes(colour =  `Income group` ,
group = `Country Name`)) +
geom_point(aes(colour =  `Income group` ))
worldBankSmaller <- worldBankSpend %>%
filter(`Country Name` %in% ourCountries)
ggplot(worldBankSmaller %>% mutate(isNewZealand = ifelse(`Country Name` == "New Zealand", "New Zealand", "Other")),
aes(x = Year, y = percSpend)) +
geom_line(aes(colour =  isNewZealand ,
group = `Country Name`)) +
geom_point(aes(colour =  isNewZealand )) +
facet_wrap(~ `Income group` )
ggplot(worldBankSmaller %>% mutate(isNewZealand = ifelse(`Country Name` == "New Zealand", "New Zealand", "Other")),
aes(x = Year, y = percSpend)) +
geom_line(aes(colour = isNewZealand,
group = `Country Name`)) +
geom_point(aes(colour = isNewZealand))
worldBankSmaller2021 <- worldBankSmaller %>%
filter(Year == 2021) %>%
arrange(desc(percSpend))
cord <- worldBankSmaller2021$`Country Name`
ggplot(worldBankSmaller2021, aes(x = `Country Name`, y = percSpend)) +
geom_bar(stat = "identity", aes(fill = Region)) +
scale_x_discrete(limits = cord) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
worldBankSmaller2021_z <- worldBankSpend %>%
filter(Year == 2021) %>%
mutate(inOrigGraph = `Country Name` %in% ourCountries)%>%
arrange(desc(percSpend))
cord <- worldBankSmaller2021_z$`Country Name`
ggplot(worldBankSmaller2021_z, aes(x = `Country Name`, y = percSpend)) +
geom_bar(stat = "identity", aes(fill = Region)) +
scale_x_discrete(limits = cord) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
worldBankSpend
View(worldBankSmaller2021_z)
worldBankSmaller2021_z <- worldBankSpend %>%
filter(Year == 2021) %>%
filter(!is.na(Region)) %>%
mutate(inOrigGraph = `Country Name` %in% ourCountries)%>%
arrange(desc(percSpend))
cord <- worldBankSmaller2021_z$`Country Name`
ggplot(worldBankSmaller2021_z, aes(x = `Country Name`, y = percSpend)) +
geom_bar(stat = "identity", aes(fill = Region)) +
scale_x_discrete(limits = cord) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
head(worldBankSmaller2021_z)
ggplot(worldBankSmaller2021_z, aes(x = `Country Name`, y = percSpend)) +
geom_bar(stat = "identity", aes(fill = `Income group`)) +
scale_x_discrete(limits = cord) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(worldBankSmaller2021_z, aes(x = `Country Name`, y = percSpend)) +
geom_bar(stat = "identity", aes(fill = inOrigGraph)) +
scale_x_discrete(limits = cord) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(worldBankSmaller2021_z, aes(x = `Country Name`, y = percSpend)) +
geom_bar(stat = "identity", aes(fill = Region)) +
scale_x_discrete(limits = cord) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
